<html>
  <head>
    <script type="text/javascript" charset="utf-8">
      const FALLBACK_URL = 'https://meta-pytorch.org';
      const REDIRECT_STYLE = {
        // Redirect completely, appending the path to the newly specified location.
        // This is useful for project renames or moving to a different org.
        FULL: 0,
        // Redirect to the specific location, losing path information
        // This is useful when you just want to capture the audience to known working page.
        SIMPLE: 1,
        // Redirect to the project's 404 page, injecting the original URL.
        FOUROHFOUR_DEFAULT: 2,
        // Redirect to the specified path, replacing ${from} with the original URL.
        FOUROHFOUR_CUSTOM: 3,
      };

      const PROJECTS = {
        forge: {
          location: 'https://meta-pytorch.org/torchforge/',
          style: REDIRECT_STYLE.FULL,
        },
      };

      // eg "https://facebook.github.io/flux/docs/overview/"
      const ORIGINAL_URL = window.location.href;
      // eg [ "", "flux", "docs", "overview", "" ]
      const PATH_PARTS = window.location.pathname.split('/');
      // eg "flux"
      const PROJECT = PATH_PARTS[1];
      // eg "docs/overview/"
      const SUBPATH = PATH_PARTS.slice(2).join('/');

      let loc = FALLBACK_URL;
      if (PROJECTS.hasOwnProperty(PROJECT)) {
        let project = PROJECTS[PROJECT];
        switch (project.style) {
          case REDIRECT_STYLE.FULL:
            loc = project.location + SUBPATH;
            break;
          case REDIRECT_STYLE.SIMPLE:
            loc = project.location;
            break;
          case REDIRECT_STYLE.FOUROHFOUR_DEFAULT:
            loc = project.location + '404.html?from=' + ORIGINAL_URL;
            break;
          case REDIRECT_STYLE.FOUROHFOUR_CUSTOM:
            loc = project.location.replace('${from}', ORIGINAL_URL);
            break;
          default:
            loc = FALLBACK_URL;
        }
      }

      window.location.href = loc;
    </script>
  </head>
  <body></body>
</html>
